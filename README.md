# Anytime valid tests of conditional independence under model-X

This repository contains replication material and additional figures for the article

Gr√ºnwald, Peter, Alexander Henzi, and Tyron Lardy. "Anytime Valid Tests of Conditional Independence Under Model-X." arXiv preprint [arXiv:2209.12637](https://arxiv.org/abs/2209.12637) (2022).
 
Code for the data application is given in the folder data_application. The file *simulation_functions.R* contains all functions used for the simulations in Section 4 of the article. The folder *simulation_1* contains the files to run the simulations for rejection rates under null and alternative hypothesis, and *simulation_2* the files for rejection rates under misspecification of the conditional distribution of X given Z. The code was run on a HPC cluster, with reproducible seed for the simulations, and the files *simulation_1.R* and *simulation_2.R* generate the output for a single run of the simulations, with parameters depending on the variable *id*. The file *simulation_tests.R* generates the plot of the 'misspecification funciton' in the article. Additional figures with different parameters for the simulations are contained in the folder *additional_figures*. The figures are generated with the file *simulation_plots.R*.

To reproduce the simulations under the alternative (files in *simulation_*) (i) select the desired parameters in the file *simulation_1.R* (positive/negative correlations, dimension, truncation level eps, penalization for RMLE) (ii) submit the batch job *sim_logistic_1_job.sh* on a HPC cluster with SLURM (adjust the email adress, partition name etc. in the shell scripts and upload all required files, including *simulation_functions.R*); this will automatically collect the resuls in a file called "results_logistic_1.rda", which (iv) be read in *simulation_plots.R* to reproduce the results. The same workflow applies to *simulation_2*.
